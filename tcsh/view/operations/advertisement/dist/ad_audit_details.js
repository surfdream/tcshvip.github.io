define(function(require,exports,module){var k=require("domains");var c=require("jquery"),f=require("wmtips"),h=require("lib"),b=require("juicer"),a=require("wmlazyload"),e=require("qq_server"),d=require("wmbox");var j={};var i=function(){a.init({lazyloadEle:"img"});e.getData(function(m){j=m});g();var l=c(".ad_img").clone(true,true).css({width:"auto",height:"auto","max-width":"auto","max-height":"auto",visibility:"hidden",position:"absolute",top:0});c("body").append(l);h.imgLoad(l.attr("src"),function(){c(".actual").empty().append(l.outerWidth()+"*"+l.outerHeight())})};var g=function(){var m=c("#page"),n=false,l=false;m.on("click",".allow",function(){var p=c(this),o=p.data("thisRelyBox");if(!o){o=d.relyBox({rely:p,content:"确定通过广告申请？",callback:function(){this.close=this.hide},sureCallBack:function(){c.ajax({url:k.api2+"/adlocation/api/check.json",data:{tempbeanid:global_setting.tempbeanid,flag:true},dataType:"jsonp",type:"get",success:function(q){if(q.success){alert("提交成功！");window.document.location.reload()}else{alert(q.error)}},error:function(){}})}});p.data("thisRelyBox",o)}o.show();return false});m.on("click",".not_allow",function(){var p=c(this),o=p.data("notAllowBox");if(!o){o=d.alert({titleText:"请说明理由",content:'<div class="not_allow_msg_mian"><textarea id="not_allow_msg" style="width: 500px;height: 200px;resize: none;"></textarea></div>',callback:function(){this.close=this.hide},btns:[{cls:"ui_btn_h26red14",res:"hide",text:"确定",callback:function(){var q=this,r=q.wmBox.find("#not_allow_msg").val();if(r.length<100){c.ajax({url:k.api2+"/adlocation/api/check.json",data:{tempbeanid:global_setting.tempbeanid,describe:r,flag:false},dataType:"jsonp",type:"get",success:function(s){if(s.success){setTimeout(function(){alert("提交成功！");window.document.location.reload()},500)}else{alert(s.error)}},error:function(){}})}else{alert("字符长度超出！")}}},{cls:"ui_btn_h26gray11",res:"hide",text:"取消",callback:function(){}}]});p.data("notAllowBox",o)}o.show();return false});m.on("click",".stop",function(){var p=c(this),o=p.data("stopBox");if(!o){o=d.alert({titleText:"请说明理由",content:'<div class="not_allow_msg_mian"><textarea id="stop_msg" style="width: 500px;height: 200px;resize: none;"></textarea></div>',callback:function(){this.close=this.hide},btns:[{cls:"ui_btn_h26red14",res:"hide",text:"确定",callback:function(){var q=this,r=q.wmBox.find("#stop_msg").val();if(r.length<100){c.ajax({url:k.api2+"/adlocation/api/put.json",data:{tempbeanid:global_setting.tempbeanid,describe:r,flag:true},dataType:"jsonp",type:"get",success:function(s){if(s.success){alert("提交成功！");window.document.location.reload()}else{alert(s.error)}},error:function(){}})}else{alert("字符长度超出！")}}},{cls:"ui_btn_h26gray11",res:"hide",text:"取消",callback:function(){}}]});p.data("stopBox",o)}o.show();return false});m.on("click",".end",function(){var o=c(this),p=o.data("endBox");if(!p){p=d.alert({titleText:"请说明理由",content:'<div class="not_allow_msg_mian"><textarea id="end_msg" style="width: 500px;height: 200px;resize: none;"></textarea></div>',callback:function(){this.close=this.hide},btns:[{cls:"ui_btn_h26red14",res:"hide",text:"确定",callback:function(){var q=this,r=q.wmBox.find("#end_msg").val();if(r.length<100){c.ajax({url:k.api2+"/adlocation/api/put.json",data:{tempbeanid:global_setting.tempbeanid,describe:r,flag:false},dataType:"jsonp",type:"get",success:function(s){if(s.success){alert("提交成功！");window.document.location.reload()}else{alert(s.error)}},error:function(){}})}else{alert("字符长度超出！")}}},{cls:"ui_btn_h26gray11",res:"hide",text:"取消",callback:function(){}}]});o.data("endBox",p)}p.show();return false});m.on("click",".restoration",function(){var p=c(this),o=p.data("confirmBox");if(!o){o=d.relyBox({rely:p,content:"确定恢复投放？",callback:function(){this.close=this.hide},sureCallBack:function(){c.ajax({url:k.api2+"/adlocation/api/restore.json",data:{tempbeanid:global_setting.tempbeanid,flag:true},dataType:"jsonp",type:"get",success:function(q){if(q.success){alert("提交成功！");window.document.location.reload()}else{alert(q.error)}},error:function(){}})}});p.data("confirmBox",o)}o.show();return false});m.on("click",".show_precision",function(){var p=c(this),o=global_setting.locateKey;p.attr("href",global_setting.url+"?"+c.param({locateKey:o,asRemarkImg:global_setting.urlList[global_setting.url].data[o].asRemarkImg}))});m.find(".user_name").hover(function(){l=true;var p=c(this),q=p.data("hoverTips"),o;if(!q){o=b(['<ul class="wm_form" style="width:200px">',"{@if linkPhone}",'<li class="form_row">','<label class="row_key">联系电话：</label>','<span class="floatleft" style="width:30px">',"{@each linkPhone as item,index}",'<span style="display:block">${linkPhone[index]}</span>',"{@/each}","</span>","</li>","{@/if}",'<li class="form_row">','<label class="row_key">联系QQ：</label>','<span class="floatleft" style="width:30px">',"{@each linkQQ as item,index}",'<a target="_blank" href="http://wpa.qq.com/msgrd?v=3&amp;uin=${linkQQ[index]}&amp;site=qq&amp;menu=yes" class="link_qq"><img bshopping_cart="0" src="http://wpa.qq.com/pa?p=2:${linkQQ[index]}:51" alt="点击这里给我发消息" title="点击这里给我发消息"></a>',"{@/each}","</span>","</li>","</ul>"].join(""));q=new f({ele:p,con:o.render(j),direction:"rt",offset:{left:20,top:0},callBack:function(){var r=this;this.$tipsBox.hover(function(){n=true},function(){n=false;setTimeout(function(){!n&&!l&&r.hide()},300)})}});p.data("hoverTips",q)}q.position();q.show()},function(){l=false;var o=c(this),p=o.data("hoverTips");setTimeout(function(){!n&&!l&&p&&p.hide()},300)})};i()});
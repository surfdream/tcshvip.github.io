define(function(require,exports,module){var k=require("domains");var c=require("jquery"),i=require("lib"),e=require("wmbox"),b=require("juicer"),h=require("api");var a=function(){var l=this;c.ajax({url:"",data:{},dataType:"json",type:"get",success:function(){},error:function(){var o={id:"1",title:"根目录",subList:[{id:"1",title:"测试1",subList:[{id:"1",title:"测试1.1",subList:[{id:"1",title:"测试1.1.1",subList:[{id:"1",title:"测试1.1.1.1",subList:[{id:"1",title:"测试1.1.1",subList:[{id:"1",title:"测试1.1.1.1.1",subList:[{id:"1",title:"测试1.1.1.1.1.1",subList:[{id:"1",title:"测试1.1.1.1.1.1.1",subList:[]}]}]}]}]}]},{id:"1",title:"测试1.1.2",subList:[{id:"1",title:"测试1.1.2.1",subList:[]}]}]},{id:"1",title:"测试1.2",subList:[{id:"1",title:"测试1.2.1",subList:[{id:"1",title:"测试1.2.1.1",subList:[]}]},{id:"1",title:"测试1.2.2",subList:[{id:"1",title:"测试1.2.2.1",subList:[]}]}]}]},{id:"1",title:"公告管理",subList:[{id:"1",title:"公告列表",subList:[]}]},{id:"1",title:"广告管理",subList:[{id:"1",title:"广告位设置",subList:[]},{id:"1",title:"广告审核",subList:[]},{id:"1",title:"已审核广告",subList:[]}]},{id:"1",title:"审核管理",subList:[{id:"1",title:"商家审核",subList:[]},{id:"1",title:"限时购审核",subList:[]},{id:"1",title:"新品预售审核",subList:[]},{id:"1",title:"美推手审核",subList:[]},{id:"1",title:"新品试用审核",subList:[]},{id:"1",title:"免费送审核",subList:[]},{id:"1",title:"兑换审核",subList:[]}]},{id:"1",title:"分类设置",subList:[{id:"1",title:"收藏分类设置",subList:[]},{id:"1",title:"用户喜好分类设置",subList:[]}]},{id:"1",title:"积分设置",subList:[{id:"1",title:"积分获取方案设置",subList:[]},{id:"1",title:"积分获取方案审核",subList:[]}]},{id:"1",title:"RBAC",subList:[{id:"1",title:"用户组列表",subList:[]},{id:"1",title:"权限组列表",subList:[]},{id:"1",title:"模块列表",subList:[]},{id:"1",title:"导航树设置",subList:[]}]},{id:"1",title:"标签",subList:[{id:"1",title:"传统标签维护",subList:[]},{id:"1",title:"消费者标签",subList:[]},{id:"1",title:"商家标签",subList:[]},{id:"1",title:"采集标签",subList:[]},{id:"1",title:"全站标签",subList:[]}]},{id:"1",title:"统计",subList:[{id:"1",title:"浏览器使用",subList:[]},{id:"1",title:"访问时间",subList:[]}]},{id:"1",title:"SEO",subList:[{id:"1",title:"基础SEO设置",subList:[]},{id:"1",title:"商品分类SEO设置",subList:[]}]},{id:"1",title:"聊天设置",subList:[{id:"1",title:"聊天头部图片设置",subList:[]}]},{id:"1",title:"全局设置",subList:[{id:"1",title:"扣点设置",subList:[]}]},]};var m=c('<dl><dt><a href="#" class="iconfont f5_tree">&#xf015c;</a><a href="#" class="nav_nide" data_id="'+o.id+'" data_name="'+o.title+'">根目录</a></dt></dl>');var n=l.wmBox.find(".nav_tree");g(m,o.subList,o.id,o.title);n.empty().append(m);l.wmBox.find(".nav_nide:eq(0)").click();l.position()}})};var g=function(r,q,p,o){var m,l;if(q&&q.length){for(var n in q){if(q[n].subList&&q[n].subList.length){m=c("<dd><dl></dl></dd>"),l=m.find("dl");l.append('<dt><a href="#" class="iconfont show_sub_btn">&#xf0175;</a><a href="#" class="nav_nide" data_id="'+q[n].id+'" data_name="'+q[n].title+'" data_parent_id="'+p+'" data_parent_name="'+o+'">'+q[n].title+"</a></dt>");g(l,q[n].subList,q[n].id,q[n].title)}else{m='<dd><a href="#" class="nav_nide get_model_page_list" data_id="'+q[n].id+'" data_name="'+q[n].title+'" data_parent_id="'+p+'" data_parent_name="'+o+'">'+q[n].title+"</a></dd>"}r.append(m)}}};var d=['<div class="ids_main">','<div class="ids_head">',"<h3>选择模块页面</h3>",'<a href="#" class="iconfont close">&#xf00b3;</a>',"</div>",'<div class="ids_con">','<div class="nav_tree"></div>','<div class="cmp_page_list_box">',"<h3></h3>",'<table class="table_list cmp_page_list" cellpadding="0" cellspacing="0">',"<thead>","<tr>",'<th class="w100">页面名称</th>','<th class="">URL</th>',"</tr>","</thead>","<tbody></tbody>","</table>","</div>",'<div class="btns">','<a href="#" class="ui_btn ui_btn_h26blue2 submit"><span class="ui_btn_txt">确定</span></a>','<a href="#" class="ui_btn ui_btn_h26white6 close"><span class="ui_btn_txt">取消</span></a>',"</div>","</div>","</div>"].join("");var f=b(["{@each page_list as item}",'<tr data_id="${item.id}" data_name="${item.name}" data_url="${item.url}" data_model_id="${id}">','<td><span class="chkbox iconfont">&#xf00b2;</span>${item.name}</td>',"<td>${item.url}</td>","</tr>","{@/each}"].join(""));var j=function(l){return e.invBox({boxCls:"inv_default_skin chk_model_page",content:d,callback:function(){var o=this,n=o.wmBox.find(".nav_tree"),m=o.wmBox.find(".cmp_page_list_box"),p=o.wmBox.find(".cmp_page_list").find("tbody");this.close=this.hide;this.wmBox.on("click",".show_sub_btn",function(){var r=c(this),q=r.closest("dd");q.addClass("show_sub_dd");r.attr("class","iconfont hide_sub_btn").empty().append("&#xf0176;");return false});this.wmBox.on("click",".hide_sub_btn",function(){var r=c(this),q=r.closest("dd");q.removeClass("show_sub_dd");r.attr("class","iconfont show_sub_btn").empty().append("&#xf0175;");return false});this.wmBox.on("click",".f5_tree",function(){a();return false});this.wmBox.on("click",".nav_nide",function(){var q=c(this);n.find(".curr").removeClass("curr");q.addClass("curr");q.parent().find(".show_sub_btn").click();return false});this.wmBox.on("click",".get_model_page_list",function(){var r=c(this);var q=r.attr("data_id");h.getModelPageList({id:q,success:function(){},error:function(){var s={id:q,page_list:[{id:"123",url:"http://s.tcsh.me/tcsh/view/operations/set_RBAC/model_list_v2.html",name:"页面名称"},{id:"123",url:"http://s.tcsh.me/tcsh/view/operations/set_RBAC/model_list_v2.html",name:"页面名称"},{id:"123",url:"http://s.tcsh.me/tcsh/view/operations/set_RBAC/model_list_v2.html",name:"页面名称"},{id:"123",url:"http://s.tcsh.me/tcsh/view/operations/set_RBAC/model_list_v2.html",name:"页面名称"},{id:"123",url:"http://s.tcsh.me/tcsh/view/operations/set_RBAC/model_list_v2.html",name:"页面名称"},{id:"123",url:"http://s.tcsh.me/tcsh/view/operations/set_RBAC/model_list_v2.html",name:"页面名称"}]};p.empty().append(f.render(s));m.find("h3").empty().append(r.attr("data_name"))}});return false});p.on("click","tr",function(){var q=c(this);p.find(".curr").removeClass("curr");q.addClass("curr")});this.wmBox.on("click",".submit",function(){var t=p.find(".curr"),s=t.attr("data_id"),q=t.attr("data_name"),v=t.attr("data_model_id"),r=t.attr("data_url");var u={id:s,name:q,model_id:v,url:r};typeof l.submitCallback==="function"&&l.submitCallback.call(o,u);o.close();return false});a.call(this)}})};exports.create=function(l){return j(c.extend({},l))}});
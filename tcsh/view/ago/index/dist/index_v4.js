define(function(require,exports,module){var k=require("domains");var d=require("jquery"),g=require("lib"),a=require("wmlazyload"),i=require("dsxy"),e=require("wmtips"),h=require("wmas"),c=require("juicer"),b=require("wmforimg");var j=function(){var o=d("body"),l=o[0],n=d("#page"),m=n.find(".class_nav");a.init();var q=c(["{@each success as item}",'<li class="comm_item">','<a href="'+k.item+'/${item.id}.html" target="_blank">','<img src="${item.product_img}"/>',"<span>${item.product_name}</span>","<span>￥${item.sale_price}</span>","</a>","</li>","{@/each}",].join(""));h.init({otherData:"logo",callback:[{key:"adv_1920_480",fun:function(){new b.Fade({forImgBoxEle:".adv_1920_480",interval:5000,callback:function(){var u=this;var t=this.forImgItem.length;var r=this.forImgBox.find(".indexBox"),s=[];while(t--){s[t]='<li class="wm_ico point_white1"></li>'}r.append(s.join(""));this.indexs=r.find("li");this.indexs.eq(0).addClass("curr");this.indexs.click(function(){u.setIndex(this)});this.automatic(true)}})}},{key:"adv_360_430",fun:function(){this.find(".brand_img img[src='']").attr("src","http://s.tcsh.me/tcsh/view/ago/index/img/logo1.jpg");this.find(".brand_name[data_name='']").append("品牌名称");new b.Slide({forImgBoxEle:".new_comm .con_row_main",interval:3000,direction:true,callback:function(){var s=this;var r=function(v){var u=this.attr("data_id"),t=this;d.ajax({url:k.api2+"/product/recommend.json",type:"get",data:{merchant_id:u,count:6},dataType:"jsonp",success:function(x){var w=d('<ul class="comm_list"></ul>');t.append(w.append(q.render(x)));typeof v==="function"&&v.call(t)},error:function(){var w=d('<ul class="comm_list"></ul>');var x={success:[{id:"0",product_name:"暂无商品",product_img:"http://s.tcsh.me/tcsh/view/public/img/img404_1.png",sale_price:0},{id:"0",product_name:"暂无商品",product_img:"http://s.tcsh.me/tcsh/view/public/img/img404_1.png",sale_price:0},{id:"0",product_name:"暂无商品",product_img:"http://s.tcsh.me/tcsh/view/public/img/img404_1.png",sale_price:0},{id:"0",product_name:"暂无商品",product_img:"http://s.tcsh.me/tcsh/view/public/img/img404_1.png",sale_price:0},{id:"0",product_name:"暂无商品",product_img:"http://s.tcsh.me/tcsh/view/public/img/img404_1.png",sale_price:0},{id:"0",product_name:"暂无商品",product_img:"http://s.tcsh.me/tcsh/view/public/img/img404_1.png",sale_price:0}]};w.append(q.render(x));t.append(w);typeof v==="function"&&v.call(t)}})};r.call(this.forImgBox.find(".brand_item:eq(0)").addClass("hover"),function(){this.find(".adv_img,.comm_list").fadeIn()});this.forImgItem.length>4&&this.automatic(true,function(){var t=s.forImgBox.find(".hover");if(!t.length||t.index()>3){t.removeClass("hover");s.forImgBox.find(".adv_img,.comm_list").stop(true,true).fadeOut();s.forImgBox.find(".brand_item:eq(0)").addClass("hover");t=s.forImgBox.find(".hover");if(!t.find(".comm_list").length){r.call(t,function(){t.find(".adv_img,.comm_list").stop(true,true).fadeIn()})}t.find(".adv_img,.comm_list").stop(true,true).fadeIn()}});this.forImgItem.hover(function(){var t=d(this);if(t.find(".comm_list").length){s.forImgBox.find(".hover").removeClass("hover");s.forImgBox.find(".adv_img,.comm_list").stop(true,true).fadeOut();t.addClass("hover");t.find(".adv_img,.comm_list").stop(true,true).fadeIn()}else{r.call(t)}},function(){})}})}}]});var p=c(["{@each list as item1}","{@if item1.sort!=0}",'<li class="ci_hoverkey">','<a href="'+k.s+'/list/${item1.id}.html" target="_blank" class="class_item"><span class="arrow">></span><span class="class_name">${item1.nickname}</span></a>','<a href="'+k.s+'/list/${item1.id}.html" target="_blank" class="class_item class_hover_item"><span class="arrow">&nbsp;</span><span class="class_name">${item1.nickname}</span></a>','<div class="sub_class">','<ul class="sub_class_list">',"{@each item1.itemList as item2}","{@if item2.row == 1}","<li>",'<a href="'+k.s+'/list/${item2.id}.html" target="_blank" class="fw700">${item2.nickname}</a><span class="hr"></span>','<ul class="end_class_list">',"{@each item2.itemList as item3}",'<li><a href="'+k.s+'/list/${item3.id}.html" target="_blank">${item3.nickname}</a></li>',"{@/each}","</ul>","</li>","{@/if}","{@/each}","</ul>",'<ul class="sub_class_list">',"{@each item1.itemList as item2}","{@if item2.row == 2}","<li>",'<a href="'+k.s+'/list/${item2.id}.html" target="_blank" class="fw700">${item2.nickname}</a><span class="hr"></span>','<ul class="end_class_list">',"{@each item2.itemList as item3}",'<li><a href="'+k.s+'/list/${item3.id}.html" target="_blank">${item3.nickname}</a></li>',"{@/each}","</ul>","</li>","{@/if}","{@/each}","</ul>","</div>","</li>","{@/if}","{@/each}"].join(""));d.ajax({url:k.api+"/category/nav",type:"get",data:{type:"array"},dataType:"jsonp",success:function(r){m.find(".class_list").empty().append(p.render({list:r}));m.find(".ci_hoverkey").hover(function(){var y=d(this),t=y.find(".sub_class"),s=t.outerHeight(),z=d(window).outerHeight(),u=parseFloat(l.scrollTop||document.documentElement.scrollTop||window.pageYOffset)||0,x,v,A=0,w=y.attr("data_hover_color");if(!t.length){v=y.find(".sub_class_data");y.append(v.html());t=y.find(".sub_class");v.remove();s=t.outerHeight()}if(w){y.find(".sub_class").css("background",w);y.find(".class_hover_item").css("background",w);y.removeAttr("data_hover_color")}y.addClass("chked");if(t.offset().top-u<=50&&s<z){t.stop().css({top:4})}x=z+u-t.offset().top-s;if(x<40){t.stop().animate({top:parseFloat(t.css("top"))+x-63})}},function(){var s=d(this);s.removeClass("chked")})}});new b.Slide({forImgBoxEle:".adv_190_240",interval:4000,callback:function(){var r=this;this.forImgBox.on("click",".prev",function(){r.prev();return false});this.forImgBox.on("click",".next",function(){r.next();return false});this.automatic(true,function(){a.triggerLazyload()})}});new b.Slide({forImgBoxEle:".popular_class",interval:3000,callback:function(){var s=this,r=this;this.forImgItem.attr("data_key",0);this.forImgItem.hover(function(){var v=d(this),t=v.index(),u=parseInt(Math.random()*999999)+99999;v.attr("data_key",u);(function(y,x,w){setTimeout(function(){if(y.attr("data_key")==w){y.stop().animate({width:740},function(){y.find(".limit").css({width:"auto"});y.find(".class_right").fadeIn()});if(x>=2){r.forImgBoxList.stop().animate({"margin-left":-240*(t-2)})}}},300)})(v,t,u)},function(){var t=d(this);t.find(".class_right").fadeOut(function(){t.find(".limit").css({width:240});t.stop().animate({width:238});t.attr("data_key",0)});r.forImgBoxList.stop().animate({"margin-left":0})});this.automatic(true);this.forImgBox.on("click",".prev",function(){if(!r.forImgBox.find(".for_img_item[data_key!='0']").length){r.prev()}return false});this.forImgBox.on("click",".next",function(){if(!r.forImgBox.find(".for_img_item[data_key!='0']").length){r.next()}return false});this.forImgBox.find(".sub_class_item a").hover(function(){var u=d(this),v=u.closest(".for_img_item"),t=v.find(".class_max_img");t.attr("href",u.attr("href"));t.find("img").attr("src",u.attr("data_img"))},function(){});this.forImgItem.each(function(){var v=d(this),t=v.find(".class_max_img"),u=v.find(".sub_class_item:eq(0) a");t.attr("href",u.attr("href"));t.find("img").attr("src",u.attr("data_img"))});this.forImgItem.css({width:238,visibility:"visible"})}});new b.Slide({forImgBoxEle:".ann_for_box",interval:4000,direction:true,callback:function(){var r=this;this.automatic(true)}});f()};var f=function(){var n=d("#page"),m=n.find(".search_form"),l=m.find(".search_form");n.find(".top_item").hover(function(){var t=d(this),q=t.attr("data_w")-0,s=t.attr("data_h")-0,p=t.find("img"),o=p.width(),r=p.height();p.stop().animate({"margin-top":s-r>=0?0:s-r,"margin-left":q-o>=0?0:q-o})},function(){var p=d(this),o=p.find("img");o.stop().animate({"margin-top":0,"margin-left":0})});n.on("click",".search_type_item",function(){var o=d(this).closest("li");o.closest("ul").prepend(o);m.attr("action",o.attr("data_action"));l.focus();return false});n.find(".search_type").hover(function(){m.addClass("showsearch_type")},function(){m.removeClass("showsearch_type")});n.on("click",".search_form .submit",function(){var o=n.find(".search_txt"),p=d.trim(o.val());if(!p){o.focus();return false}})};j()});
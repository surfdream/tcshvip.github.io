define(function(g,p,c){var e=g("http://a.mysodao.com/out_service/emotion/dist/sea_jquery.js"),k=g("http://a.mysodao.com/out_service/emotion/dist/juicer-min.js");var b,h,s,f,r,j,l,a,o,o,n,d,i;var q=function(){var w=function(){var y=s.find(".ed").index(),z=s.find(".sodao_min_img_item").length;o.addClass("sodao_end");n.addClass("sodao_end");if(z&&y<z-1){o.removeClass("sodao_end")}if(z&&y>0){n.removeClass("sodao_end")}},t=function(){var y=parseInt(j.attr("month"),10);a.removeClass("sodao_end");l.removeClass("sodao_end");if(y<=1){a.addClass("sodao_end")}if(y>=12){l.addClass("sodao_end")}},x=function(B,z,y,A){f.closest("a").attr("href",y);r.html(z).attr("href",A);if(f.attr("src")==B){return}f.stop(true,true);f.fadeOut(0);f.fadeIn(300);f.attr("src",B)},v=function(){var B=h.find(".ed"),A=B.outerHeight(),y=B.position(),C=(A*3)-y.top+30,z=s.find(".sodao_min_img_item").length;if(z>6&&y.top>A*3&&B.index()<z-2){s.stop(true,true);s.animate({top:C},300)}if(z>6&&B.index()>=z-2){s.stop(true,true);s.animate({top:(A*3)-s.find(".sodao_min_img_item:eq("+(z-3)+")").position().top+30},300)}},u=function(y){j.val(y+"月");j.attr("month",y);t();e.ajax({url:"http://app.sodao.com/showTimeUnion/calendarList?jsonp=?",type:"get",dataType:"jsonp",cache:true,data:{mm:y},cache:false,success:function(A){f.attr("src","");var z=A.CalendarList.length;while(z--){A.CalendarList[z].day=A.CalendarList[z].date.substring(2,4)-0;A.CalendarList[z].day==i&&x(A.CalendarList[z].imgpath,A.CalendarList[z].desc,A.CalendarList[z].imgLink,A.CalendarList[z].descLink)}s.html(b.render(A));h.find(".sodao_min_img_item:[day='"+i+"']").addClass("ed");if(!f.attr("src")){x(A.CalendarList[0].imgpath,A.CalendarList[0].desc,A.CalendarList[0].imgLink,A.CalendarList[0].descLink);h.find(".sodao_min_img_item:[day='"+A.CalendarList[0].day+"']").addClass("ed")}w();s.css("top",0);v()}})};h.on("click",".sodao_end",function(){return false});h.on("click",".entrance_btn",function(y){y.preventDefault();var z=e(this);!s.find(".sodao_min_img_item").length&&u(d.getMonth()+1);z.closest(".entrance").toggleClass("current")});h.on("click",".sodao_min_img_item",function(y){y.preventDefault();var z=e(this);z.closest(".sodao_min_img_ul_list").find(".ed").removeClass("ed");z.addClass("ed");x(z.attr("imgpath"),z.attr("desc"),z.attr("imglink"),z.attr("desclink"));w();v()});h.on("click",".sodao_next_month:not(.sodao_end)",function(z){z.preventDefault();var y=j.attr("month")-0+1;if(y>=12){y=12}u(y)});h.on("click",".sodao_prev_month:not(.sodao_end)",function(z){z.preventDefault();var y=j.attr("month")-0-1;if(y<=1){y=1}u(y)});h.on("keyup",".sodao_txt_month",function(z){if(z.keyCode===13){var A=e(this),y;y=parseInt(A.val(),10);if(!y){y=d.getMonth()+1}if(y<=1){y=1}if(y>=12){y=12}u(y)}});h.on("click",".sodao_next_item:not(.sodao_end)",function(y){y.preventDefault();s.find(".ed").next(".sodao_min_img_item:eq(0)").click()});h.on("click",".sodao_prev_item:not(.sodao_end)",function(y){y.preventDefault();s.find(".ed").prev(".sodao_min_img_item:eq(0)").click()})};var m=function(){e("body").append('<div id="sodao_to_emotion"><div class="entrance"><a class="entrance_btn"><i class="ico date_ico"></i><span>EMUI日历</span><i class="ico direction_ico"></i> </a><div class="min_img_sodaoMM"><div class="sodao_date"><a href="#" class="sodao_btn sodao_prev_month"></a><input type="text" class="sodao_txt_month"><a href="#" class="sodao_btn sodao_next_month"></a></div><div class="sodao_min_img_list"><a href="#" class="sodao_btn sodao_prev_item sodao_end"></a><div class="sodao_ab_box"><ul class="sodao_min_img_ul_list"></ul></div><a href="#" class="sodao_btn sodao_next_item sodao_end"></a></div></div><div class="big_img_sodao_MM"><div class="sodao_big_img_bg"><a href="#" target="_blank"><img id="sodao_big_user_img" src="" border="0" width="630" height="420"></a><a class="sodao_user_data" href="#" target="_blank">&nbsp;</a></div><div class="sodao_bg_wave"></div></div></div></div>');b=k(["{@each CalendarList as item}",'<li class="sodao_min_img_item" imgpath="${item.imgpath}" day="${item.day}" desc="${item.desc}" imglink="${item.imgLink}" desclink="${item.descLink}">','<img src="${item.simgpath}" width="70" height="47">','<div class="sodao_min_img_mask">',"<p>${item.day}号</p>","</div>","</li>","{@/each}"].join("")),h=e("#sodao_to_emotion"),s=h.find(".sodao_min_img_ul_list"),f=h.find("#sodao_big_user_img"),r=h.find(".sodao_user_data"),j=h.find(".sodao_txt_month"),l=h.find(".sodao_next_month"),a=h.find(".sodao_prev_month"),o=h.find(".sodao_next_item"),n=h.find(".sodao_prev_item"),d=new Date(),i=d.getDate()};p.init=function(){e(function(){m();q()})}});